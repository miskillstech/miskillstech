/*!CK:3731438809!*//*1457381935,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["vP2xz"]); }

__d('OGCollectionAddObject',['csx','cx','AsyncRequest','CSS','DOM','DOMQuery','Form','JSLogger','Parent','ProfileOverviewSection','TidyArbiterMixin','TimelineAppCollection','ge'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('JSLogger').create('og_collection_add_object'),k=babelHelpers['extends']({ADD_PLACEHOLDER:'OGCollectionAddObject/addPlaceholder',NEW_ITEM:'OGCollectionAddObject/newItem',PLACEHOLDER:'OGCollectionAddObject/placeholder',REMOVE_PLACEHOLDER:'OGCollectionAddObject/removePlaceholder',init:function(l,m,n,o){c('ProfileOverviewSection').callWithSection(o,function(p){this.initImpl(l,m,n,p.getNode(),o,p.id);}.bind(this));},initInReport:function(l,m,n){var o=c('Parent').bySelector(n,"._w8_");this.initImpl(l,m,n,o,null,null);},initImpl:function(l,m,n,o,p,q){var r=c('DOMQuery').scry(o,"._620")[0];if(!r){j.error('grid_not_found',{collection_id:p,section:q,csx:'.public/fbTimelineCollectionGrid/root'});return;}m.subscribe('select',function(s,t){if(!t.selected.uid||t.selected.type.indexOf('disabled')!=-1)return;k.inform(k.ADD_PLACEHOLDER,p);var u=r.nextSibling,v=null;if(u&&c('CSS').hasClass(u,"_3t3")){c('CSS').hide(r.lastChild);v=r.lastChild;}c('TimelineAppCollection').addGenericPlaceholderToCollection(c('Form').serialize(n).collection_token,{entityID:t.selected.uid});k.inform(k.PLACEHOLDER,{grid:r});var w=babelHelpers['extends']({action:'add',mechanism:'typeahead'},c('Form').serialize(n));new (c('AsyncRequest'))().setURI(l).setData(w).setRelativeTo(r).setErrorHandler(function(x){var y=c('DOM').scry(r,'[data-item="'+t.selected.uid+'"]')[0];if(y)c('DOM').remove(y);k.inform(k.REMOVE_PLACEHOLDER,p);v&&c('CSS').show(v);}).setHandler(function(x){v&&c('DOM').remove(v);}).setFinallyHandler(function(x){k.inform(k.PLACEHOLDER,{grid:r});}).send();});},replaceItem:function(l,m,n){var o=c('DOM').scry(l,'div[data-obj="'+m+'"]')[0];if(o){var p=c('Parent').bySelector(o,"._30f");if(p)k.inform(k.REMOVE_PLACEHOLDER,p.id);c('DOM').remove(o.parentNode);}var q=c('DOM').find(l,'[data-item="'+m+'"]'+"._2804");c('DOM').replace(q,n);this.inform(k.NEW_ITEM,{grid:l,newItem:n});},prependItem:function(l,m){var n=c('DOMQuery').scry(c('ge')(l),"._620")[0];c('DOM').prependContent(n,m);this.inform(k.NEW_ITEM,{grid:n,newItem:m});}},c('TidyArbiterMixin'));f.exports=k;},null);
__d('CollectionsRecommendationViewportTracking',['csx','DOM','ViewportTracking'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=55,l=200;i=babelHelpers.inherits(m,c('ViewportTracking'));j=i&&i.prototype;m.prototype.getDataFromConfig=function(n){'use strict';this.control=n.control;this.useBanzai=false;};m.prototype.getTimeout=function(){'use strict';return l;};m.prototype.getAllStories=function(){'use strict';var n=[].concat(c('DOM').scry(this.control,"._3owb")).concat(c('DOM').scry(this.control,"._5jvf")).concat(c('DOM').scry(this.control,"._3cxw"));return n;};m.prototype.getStoryID=function(n){'use strict';var o=JSON.parse(n.getAttribute('data-gt'));return o&&o.token;};m.prototype.getDataToLog=function(n){'use strict';var o=Object.assign(JSON.parse(n.getAttribute('data-gt'))||{},{evt:k});return {gt:o};};m.init=function(n){'use strict';var o=new m();o.init(n);return o;};function m(){'use strict';i.apply(this,arguments);}f.exports=m;},null);
__d('TimelineCollectionAddRecommendation',['csx','cx','AppSectionCurationState','AsyncRequest','AsyncResponse','CollectionsRecommendationViewportTracking','CSS','DataStore','DOM','Event','OGCollectionAddObject','OnVisible','Parent','ProfileOverviewSection','TimelineAppCollection','TimelineAppSection','TimelineAppSectionCuration','TriggerablePageletLoader','$','tidyEvent'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={},k="_5737",l=250;c('OGCollectionAddObject').subscribe(c('OGCollectionAddObject').ADD_PLACEHOLDER,function(u,v){c('TimelineAppCollection').incrementCount(v);});c('OGCollectionAddObject').subscribe(c('OGCollectionAddObject').REMOVE_PLACEHOLDER,function(u,v){c('TimelineAppCollection').decrementCount(v);});function m(u){var v=c('DOM').scry(u,"._3owb")[0];if(v)return v.getAttribute('data-obj');}function n(u,v){if(v){var w=v.nextSibling;w&&r(w);j[u].carousel.removeItem(v);}j[u].carousel.refresh();}function o(u,v){var w=[],x=j[u].carousel.getVisibleNodes(),y=m(v);for(var z=0;z<x.length;++z){var aa=m(x[z]);if(y===aa)break;if(aa)w.push(aa);}return w;}function p(u){var v=[],w=j[u].carousel.getVisibleNodes(),x=j[u].carousel.getVisibleNodesMax();for(var y=1;y<x-1;y++){if(y===w.lentgh)break;var z=m(w[y]);if(z)v.push(z);}return v;}function q(u,v){var w=o(u,v);n(u,v);return w;}function r(u){c('CSS').addClass(u,"_42fn");var v=c('Event').listen(u,'mouseover',function(){c('CSS').removeClass(u,"_42fn");v.remove();});}function s(u){var v=j[u];if(v.filled)return;var w=c('TimelineAppSection').getIDBySK(v.data.sk);c('ProfileOverviewSection').callWithSection(w,function(x){var y=x.getActiveCollection().getToken(),z=c('TimelineAppSectionCuration').getSectionState(w);if(y==v.collectionToken&&z===c('AppSectionCurationState').showItems&&v.items.length>0){v.filled=true;v.carousel.addItems(v.items);}});}var t={addTriggerLoader:function(u,v,w){new (c('TriggerablePageletLoader'))({controller:'TimelineAppCollectionRecommendationPagelet',data:w,node:u,options:{crossPage:1,jsNonblock:1}},[{node:v,type:c('TriggerablePageletLoader').TRIGGER_ONVISIBLE}]);},removeItemsByObjectIDs:function(u,v){var w=j[v];if(!w)return;var x=j[v].carousel.getNode();u.forEach(function(y){var z=c('DOM').scry(x,'[data-obj="'+y+'"]')[0];if(z){var aa=c('Parent').bySelector(z,"._58rc");q(v,aa);}});},getPreviousItemIDs:function(u,v){return o(u,v);},getPageletID:function(u){return 'pagelet_recommendation_'+u.split(':')[2];},init:function(u,v,w,x){var y=j[u]={carousel:v,collectionToken:w.collection_token,data:w,isFirst:true,showPlusButtonItem:x.items[0],items:x.items,postUri:x.post_uri,removeUri:x.remove_uri,nextLinkData:x.next_link_data,filled:x.filled,headerPageletID:x.header_pagelet_id,viewportTracking:c('CollectionsRecommendationViewportTracking').init({control:v.getNode()})};new (c('OnVisible'))(y.carousel.getNode(),function(){var aa=function(){s(u);};c('TimelineAppSection').subscribe('changeCollection',aa);c('TimelineAppSectionCuration').register(c('TimelineAppSection').getIDBySK(w.sk),aa);aa();},true,0);var z=c('Event').listen(y.carousel.getNode(),'mouseenter',function(aa){z.remove();if(y.showPlusButtonItem)c('CSS').removeClass(y.showPlusButtonItem,k);});c('tidyEvent')([y.carousel.subscribe('needsitems',t.reloadRecommendation.bind(null,y)),y.carousel.subscribe('refreshed',y.viewportTracking.fireTimer.bind(y.viewportTracking)),y.carousel.subscribe('lastelementremoved',function(aa){c('TimelineAppSectionCuration').informState(c('AppSectionCurationState').hide,w.header_pagelet_id);setTimeout(function(){c('TimelineAppCollection').switchToNullStateCurationContent(w.collection_token);},l);})]);c('tidyEvent')(c('Event').listen(y.carousel.getNextLink(),'mousedown',function(aa){y.nextLinkData.rec_list_items=p(u);y.carousel.getNextLink().setAttribute('data-gt',JSON.stringify(y.nextLinkData));}));c('tidyEvent')(c('Event').listen(y.carousel.getNode(),'click',function(aa){var ba=c('Parent').byTag(aa.getTarget(),'a');if(!ba)return;var ca="_gx8",da="_vfm",ea="_4-k4",fa=c('CSS').hasClass(ba,ca)||c('CSS').hasClass(ba,da),ga=!fa&&c('CSS').hasClass(ba,ea);if(fa||ga){var ha=c('Parent').bySelector(ba,"._58rc"),ia=c('DOM').find(ha,"._3owb"),ja=ia.getAttribute('data-obj'),ka=JSON.parse(c('DataStore').get(ia,'post',null)),la=q(u,ha);if(fa){c('TimelineAppCollection').addGenericPlaceholderToCollection(y.collectionToken,{entityID:ja});var ma=y.isFirst||0;delete y.isFirst;new (c('AsyncRequest'))(y.postUri).setData(babelHelpers['extends']({action:'add',item_id:ja,ignored_item_ids:la,is_first:ma,underlying_entity_id:ja,log_feedback:Number(w.taste_items_ids.hasOwnProperty(ja))},ka)).setErrorHandler(function(na){c('AsyncResponse').defaultErrorHandler(na);c('TimelineAppCollection').removePlaceholderFromCollection(y.collectionToken,ja);}).send();aa.prevent();}else new (c('AsyncRequest'))(y.removeUri).setData(babelHelpers['extends']({objectid:ja,ignored_item_ids:la},ka)).send();}}));},reloadRecommendation:function(u){if(!u.asyncing&&u.filled)u.asyncing=new (c('AsyncRequest'))('/ajax/open_graph/recommendation_reload/').setData(u.data).send();},requestSuggestions:function(u,v){if(!(u in j))return;var w=j[u].data;new (c('AsyncRequest'))('/ajax/open_graph/similar_suggestions/').setData({pagelet_id:u,ogobjectid:v,session_id:w.session_id,collection_token:w.collection_token}).setRelativeTo(c('$')(c('TimelineAppSection').getIDBySK(w.sk))).setHandler(this.onRequestSuggestionsComplete.bind(this,u)).send();},onRequestSuggestionsComplete:function(u){c('TimelineAppSectionCuration').refreshState(c('AppSectionCurationState').showItems,c('TimelineAppSection').getIDBySK(j[u].data.sk));},removeItemFromRecommendations:function(u,v){return q(u,v);},plusRecommendation:function(u,v,w,x,y,z){var aa=j[u];c('TimelineAppCollection').addPlaceholderToCollection(y,w);var ba=j[v];if(u!=v&&ba){var ca=c('DOM').scry(ba.carousel.getNode(),'[data-obj="'+x+'"]');if(ca&&ca.length>0){var da=c('Parent').bySelector(ca[0],"._58rc");n(v,da);}}var ea=null;if(z){ea=q(u,w);}else ea=o(u,w);var fa=aa.isFirst||0;delete aa.isFirst;return {ignored_item_ids:ea,is_first:fa,session_id:aa.sessionID};},populateSuggestionsList:function(u,v,w,x,y){var z=j[u];z.asyncing=false;if(v.length===0){z.carousel.endCarousel();}else{z.data.exclude_ids=w;Object.assign(z.data.taste_items_ids||{},x);z.carousel.addItems(v);z.data.cursor=y;}}};f.exports=t;},null);
__d('TimelineCollectionAddTagSuggestItem',['cx','csx','Arbiter','Ease','Parent','DOM','CSS','Animation','TimelineCollectionAddRecommendation'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k,l,m,n,o){'use strict';this.$TimelineCollectionAddTagSuggestItem1=l;this.$TimelineCollectionAddTagSuggestItem2=m;this.$TimelineCollectionAddTagSuggestItem3=o;this.$TimelineCollectionAddTagSuggestItem4=c('Parent').byAttribute(l,k);this.$TimelineCollectionAddTagSuggestItem5=c('DOM').scry(l,"._2ca6")[0];this.$TimelineCollectionAddTagSuggestItem6=c('DOM').find(l,"._5epd");this.$TimelineCollectionAddTagSuggestItem7=c('DOM').find(l,"._2ca7");this.$TimelineCollectionAddTagSuggestItem8=c('DOM').find(l,"._2ca8");this.$TimelineCollectionAddTagSuggestItem9=c('DOM').find(l,"._5ep9");n.subscribe('confirm',this.$TimelineCollectionAddTagSuggestItem10.bind(this));n.subscribe('reject',this.$TimelineCollectionAddTagSuggestItem11.bind(this));c('Arbiter').subscribe('PhotoTagger.TAG_SUGGESTION_CONFIRMED/'+this.$TimelineCollectionAddTagSuggestItem3,this.$TimelineCollectionAddTagSuggestItem10.bind(this));c('Arbiter').subscribe('PhotoTagger.TAG_SUGGESTION_REJECTED/'+this.$TimelineCollectionAddTagSuggestItem3,this.$TimelineCollectionAddTagSuggestItem11.bind(this));}j.prototype.$TimelineCollectionAddTagSuggestItem10=function(){'use strict';this.$TimelineCollectionAddTagSuggestItem12();this.$TimelineCollectionAddTagSuggestItem13(this.$TimelineCollectionAddTagSuggestItem6,1,.4,400).go();this.$TimelineCollectionAddTagSuggestItem13(this.$TimelineCollectionAddTagSuggestItem7,0,1,400).go();setTimeout(function(){this.$TimelineCollectionAddTagSuggestItem13(this.$TimelineCollectionAddTagSuggestItem1,1,0,400).checkpoint(1,this.$TimelineCollectionAddTagSuggestItem14.bind(this)).go();}.bind(this),750);};j.prototype.$TimelineCollectionAddTagSuggestItem11=function(){'use strict';this.$TimelineCollectionAddTagSuggestItem12();this.$TimelineCollectionAddTagSuggestItem13(this.$TimelineCollectionAddTagSuggestItem6,1,.4,600).go();this.$TimelineCollectionAddTagSuggestItem13(this.$TimelineCollectionAddTagSuggestItem1,1,0,600).checkpoint(1,this.$TimelineCollectionAddTagSuggestItem14.bind(this)).go();};j.prototype.$TimelineCollectionAddTagSuggestItem12=function(){'use strict';c('CSS').hide(this.$TimelineCollectionAddTagSuggestItem5);c('CSS').hide(this.$TimelineCollectionAddTagSuggestItem8);c('CSS').hide(this.$TimelineCollectionAddTagSuggestItem9);c('CSS').addClass(this.$TimelineCollectionAddTagSuggestItem1,"_2ca5");};j.prototype.$TimelineCollectionAddTagSuggestItem13=function(k,l,m,n){'use strict';return new (c('Animation'))(k).from('opacity',l).to('opacity',m).ease(c('Ease').makePowerInOut(2)).duration(n);};j.prototype.$TimelineCollectionAddTagSuggestItem14=function(){'use strict';c('TimelineCollectionAddRecommendation').removeItemFromRecommendations(this.$TimelineCollectionAddTagSuggestItem2,this.$TimelineCollectionAddTagSuggestItem4);};f.exports=j;},null);
__d('TimelineCollectionAddTagSuggestSelector',['AsyncRequest','ArbiterMixin','tidyEvent','mixin','Event'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k,l,m,n,o,p){'use strict';i.constructor.call(this);this.$TimelineCollectionAddTagSuggestSelector1=k;this.$TimelineCollectionAddTagSuggestSelector2=o;this.$TimelineCollectionAddTagSuggestSelector3=p;c('tidyEvent')(c('Event').listen(k,'click',this.$TimelineCollectionAddTagSuggestSelector4.bind(this,m,'confirm')),c('Event').listen(l,'click',this.$TimelineCollectionAddTagSuggestSelector4.bind(this,n,'reject')));}j.prototype.$TimelineCollectionAddTagSuggestSelector4=function(k,event){'use strict';this.inform(event);new (c('AsyncRequest'))(k).setData(this.$TimelineCollectionAddTagSuggestSelector5(event)).send();};j.prototype.$TimelineCollectionAddTagSuggestSelector5=function(event){'use strict';return event=='confirm'?this.$TimelineCollectionAddTagSuggestSelector2:this.$TimelineCollectionAddTagSuggestSelector3;};f.exports=j;},null);